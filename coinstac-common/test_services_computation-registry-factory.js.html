<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>test/services/computation-registry-factory.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Base.html">Base</a><ul class='methods'><li data-type='method'><a href="Base.html#serialize">serialize</a></li><li data-type='method'><a href="Base.html#toJSON">toJSON</a></li></ul></li><li><a href="CommandComputation.html">CommandComputation</a><ul class='methods'><li data-type='method'><a href="CommandComputation.html#run">run</a></li><li data-type='method'><a href="CommandComputation.html#serialize">serialize</a></li><li data-type='method'><a href="CommandComputation.html#toJSON">toJSON</a></li></ul></li><li><a href="Computation.html">Computation</a><ul class='methods'><li data-type='method'><a href="Computation.html#.factory">factory</a></li><li data-type='method'><a href="Computation.html#run">run</a></li><li data-type='method'><a href="Computation.html#serialize">serialize</a></li><li data-type='method'><a href="Computation.html#toJSON">toJSON</a></li></ul></li><li><a href="ComputationRegistry.html">ComputationRegistry</a><ul class='methods'><li data-type='method'><a href="ComputationRegistry.html#.getNameAndVersion">getNameAndVersion</a></li><li data-type='method'><a href="ComputationRegistry.html#add">add</a></li><li data-type='method'><a href="ComputationRegistry.html#all">all</a></li><li data-type='method'><a href="ComputationRegistry.html#get">get</a></li><li data-type='method'><a href="ComputationRegistry.html#remove">remove</a></li></ul></li><li><a href="ComputationResult.html">ComputationResult</a><ul class='methods'><li data-type='method'><a href="ComputationResult.html#serialize">serialize</a></li><li data-type='method'><a href="ComputationResult.html#toJSON">toJSON</a></li></ul></li><li><a href="Consortium.html">Consortium</a><ul class='methods'><li data-type='method'><a href="Consortium.html#.compareUsernames">compareUsernames</a></li><li data-type='method'><a href="Consortium.html#hasMember">hasMember</a></li><li data-type='method'><a href="Consortium.html#isOwnedBy">isOwnedBy</a></li><li data-type='method'><a href="Consortium.html#serialize">serialize</a></li><li data-type='method'><a href="Consortium.html#toJSON">toJSON</a></li></ul></li><li><a href="DBListener.html">DBListener</a><ul class='methods'><li data-type='method'><a href="DBListener.html#destroy">destroy</a></li></ul></li><li><a href="DecentralizedComputation.html">DecentralizedComputation</a><ul class='methods'><li data-type='method'><a href="DecentralizedComputation.html#serialize">serialize</a></li><li data-type='method'><a href="DecentralizedComputation.html#toJSON">toJSON</a></li></ul></li><li><a href="File.html">File</a><ul class='methods'><li data-type='method'><a href="File.html#serialize">serialize</a></li><li data-type='method'><a href="File.html#toJSON">toJSON</a></li></ul></li><li><a href="JavascriptComputation.html">JavascriptComputation</a><ul class='methods'><li data-type='method'><a href="JavascriptComputation.html#run">run</a></li><li data-type='method'><a href="JavascriptComputation.html#serialize">serialize</a></li><li data-type='method'><a href="JavascriptComputation.html#toJSON">toJSON</a></li></ul></li><li><a href="LocalComputationResult.html">LocalComputationResult</a><ul class='methods'><li data-type='method'><a href="LocalComputationResult.html#serialize">serialize</a></li><li data-type='method'><a href="LocalComputationResult.html#toJSON">toJSON</a></li></ul></li><li><a href="LocalPipelineRunner.html">LocalPipelineRunner</a><ul class='methods'><li data-type='method'><a href="LocalPipelineRunner.html#findResultByRunId">findResultByRunId</a></li><li data-type='method'><a href="LocalPipelineRunner.html#getPreviousResultData">getPreviousResultData</a></li><li data-type='method'><a href="LocalPipelineRunner.html#getResultDocs">getResultDocs</a></li><li data-type='method'><a href="LocalPipelineRunner.html#run">run</a></li><li data-type='method'><a href="LocalPipelineRunner.html#saveResult">saveResult</a></li><li data-type='method'><a href="LocalPipelineRunner.html#serialize">serialize</a></li><li data-type='method'><a href="LocalPipelineRunner.html#toJSON">toJSON</a></li></ul></li><li><a href="LocalPipelineRunnerPool.html">LocalPipelineRunnerPool</a><ul class='methods'><li data-type='method'><a href="LocalPipelineRunnerPool.html#createNewRunner">createNewRunner</a></li><li data-type='method'><a href="LocalPipelineRunnerPool.html#destroy">destroy</a></li><li data-type='method'><a href="LocalPipelineRunnerPool.html#getDecentralizedComputation">getDecentralizedComputation</a></li><li data-type='method'><a href="LocalPipelineRunnerPool.html#getLatestResult">getLatestResult</a></li><li data-type='method'><a href="LocalPipelineRunnerPool.html#getLocalResult">getLocalResult</a></li><li data-type='method'><a href="LocalPipelineRunnerPool.html#getPipelinePlugins">getPipelinePlugins</a></li><li data-type='method'><a href="LocalPipelineRunnerPool.html#handleResultChange">handleResultChange</a></li><li data-type='method'><a href="LocalPipelineRunnerPool.html#init">init</a></li><li data-type='method'><a href="LocalPipelineRunnerPool.html#listenToConsortia">listenToConsortia</a></li><li data-type='method'><a href="LocalPipelineRunnerPool.html#serialize">serialize</a></li><li data-type='method'><a href="LocalPipelineRunnerPool.html#toJSON">toJSON</a></li><li data-type='method'><a href="LocalPipelineRunnerPool.html#triggerRunner">triggerRunner</a></li><li data-type='method'><a href="LocalPipelineRunnerPool.html#unlistenToConsortia">unlistenToConsortia</a></li><li data-type='method'><a href="LocalPipelineRunnerPool.html#upsertListener">upsertListener</a></li></ul></li><li><a href="Pipeline.html">Pipeline</a><ul class='methods'><li data-type='method'><a href="Pipeline.html#run">run</a></li><li data-type='method'><a href="Pipeline.html#serialize">serialize</a></li><li data-type='method'><a href="Pipeline.html#toJSON">toJSON</a></li></ul></li><li><a href="PipelineRunner.html">PipelineRunner</a><ul class='methods'><li data-type='method'><a href="PipelineRunner.html#findResultByRunId">findResultByRunId</a></li><li data-type='method'><a href="PipelineRunner.html#getPreviousResultData">getPreviousResultData</a></li><li data-type='method'><a href="PipelineRunner.html#getResultDocs">getResultDocs</a></li><li data-type='method'><a href="PipelineRunner.html#run">run</a></li><li data-type='method'><a href="PipelineRunner.html#saveResult">saveResult</a></li><li data-type='method'><a href="PipelineRunner.html#serialize">serialize</a></li><li data-type='method'><a href="PipelineRunner.html#toJSON">toJSON</a></li></ul></li><li><a href="PipelineRunnerPool.html">PipelineRunnerPool</a><ul class='methods'><li data-type='method'><a href="PipelineRunnerPool.html#createNewRunner">createNewRunner</a></li><li data-type='method'><a href="PipelineRunnerPool.html#destroy">destroy</a></li><li data-type='method'><a href="PipelineRunnerPool.html#getDecentralizedComputation">getDecentralizedComputation</a></li><li data-type='method'><a href="PipelineRunnerPool.html#getPipelinePlugins">getPipelinePlugins</a></li><li data-type='method'><a href="PipelineRunnerPool.html#handleResultChange">handleResultChange</a></li><li data-type='method'><a href="PipelineRunnerPool.html#init">init</a></li><li data-type='method'><a href="PipelineRunnerPool.html#listenToConsortia">listenToConsortia</a></li><li data-type='method'><a href="PipelineRunnerPool.html#serialize">serialize</a></li><li data-type='method'><a href="PipelineRunnerPool.html#toJSON">toJSON</a></li><li data-type='method'><a href="PipelineRunnerPool.html#triggerRunner">triggerRunner</a></li><li data-type='method'><a href="PipelineRunnerPool.html#unlistenToConsortia">unlistenToConsortia</a></li><li data-type='method'><a href="PipelineRunnerPool.html#upsertListener">upsertListener</a></li></ul></li><li><a href="PouchDocument.html">PouchDocument</a><ul class='methods'><li data-type='method'><a href="PouchDocument.html#serialize">serialize</a></li><li data-type='method'><a href="PouchDocument.html#toJSON">toJSON</a></li></ul></li><li><a href="Project.html">Project</a><ul class='methods'><li data-type='method'><a href="Project.html#serialize">serialize</a></li><li data-type='method'><a href="Project.html#toJSON">toJSON</a></li></ul></li><li><a href="RemoteComputationResult.html">RemoteComputationResult</a><ul class='methods'><li data-type='method'><a href="RemoteComputationResult.html#serialize">serialize</a></li><li data-type='method'><a href="RemoteComputationResult.html#toJSON">toJSON</a></li></ul></li><li><a href="RemotePipelineRunner.html">RemotePipelineRunner</a><ul class='methods'><li data-type='method'><a href="RemotePipelineRunner.html#findResultByRunId">findResultByRunId</a></li><li data-type='method'><a href="RemotePipelineRunner.html#getPreviousResultData">getPreviousResultData</a></li><li data-type='method'><a href="RemotePipelineRunner.html#getResultDocs">getResultDocs</a></li><li data-type='method'><a href="RemotePipelineRunner.html#getUserErrors">getUserErrors</a></li><li data-type='method'><a href="RemotePipelineRunner.html#run">run</a></li><li data-type='method'><a href="RemotePipelineRunner.html#saveResult">saveResult</a></li><li data-type='method'><a href="RemotePipelineRunner.html#serialize">serialize</a></li><li data-type='method'><a href="RemotePipelineRunner.html#toJSON">toJSON</a></li></ul></li><li><a href="RemotePipelineRunnerPool.html">RemotePipelineRunnerPool</a><ul class='methods'><li data-type='method'><a href="RemotePipelineRunnerPool.html#buildNewRemoteResult">buildNewRemoteResult</a></li><li data-type='method'><a href="RemotePipelineRunnerPool.html#createNewRunner">createNewRunner</a></li><li data-type='method'><a href="RemotePipelineRunnerPool.html#destroy">destroy</a></li><li data-type='method'><a href="RemotePipelineRunnerPool.html#getDecentralizedComputation">getDecentralizedComputation</a></li><li data-type='method'><a href="RemotePipelineRunnerPool.html#getLatestResult">getLatestResult</a></li><li data-type='method'><a href="RemotePipelineRunnerPool.html#getPipelinePlugins">getPipelinePlugins</a></li><li data-type='method'><a href="RemotePipelineRunnerPool.html#getRemoteResult">getRemoteResult</a></li><li data-type='method'><a href="RemotePipelineRunnerPool.html#handleResultChange">handleResultChange</a></li><li data-type='method'><a href="RemotePipelineRunnerPool.html#init">init</a></li><li data-type='method'><a href="RemotePipelineRunnerPool.html#listenToConsortia">listenToConsortia</a></li><li data-type='method'><a href="RemotePipelineRunnerPool.html#serialize">serialize</a></li><li data-type='method'><a href="RemotePipelineRunnerPool.html#toJSON">toJSON</a></li><li data-type='method'><a href="RemotePipelineRunnerPool.html#triggerRunner">triggerRunner</a></li><li data-type='method'><a href="RemotePipelineRunnerPool.html#unlistenToConsortia">unlistenToConsortia</a></li><li data-type='method'><a href="RemotePipelineRunnerPool.html#upsertListener">upsertListener</a></li></ul></li><li><a href="User.html">User</a><ul class='methods'><li data-type='method'><a href="User.html#serialize">serialize</a></li><li data-type='method'><a href="User.html#toJSON">toJSON</a></li></ul></li></ul><h3>Modules</h3><ul><li><a href="module-services_computation-registry-factory.html">services/computation-registry-factory</a><ul class='methods'><li data-type='method'><a href="module-services_computation-registry-factory.html#~computationRegistryFactory">computationRegistryFactory</a></li></ul></li><li><a href="module-services_db-registry.html">services/db-registry</a><ul class='methods'><li data-type='method'><a href="module-services_db-registry.html#~dbRegistryFactory">dbRegistryFactory</a></li></ul></li></ul><h3>Events</h3><ul><li><a href="DBListener.html#event:change">change</a></li><li><a href="DBListener.html#event:delete">delete</a></li><li><a href="LocalPipelineRunner.html#event:noop:noData">noop:noData</a></li><li><a href="LocalPipelineRunner.html#event:noop:noStateChange">noop:noStateChange</a></li><li><a href="LocalPipelineRunnerPool.html#event:computation:complete">computation:complete</a></li><li><a href="LocalPipelineRunnerPool.html#event:ready">ready</a></li><li><a href="LocalPipelineRunnerPool.html#event:listener:created">listener:created</a></li><li><a href="LocalPipelineRunnerPool.html#event:pipeline:inProgress">pipeline:inProgress</a></li><li><a href="LocalPipelineRunnerPool.html#event:queue:end">queue:end</a></li><li><a href="LocalPipelineRunnerPool.html#event:queue:start">queue:start</a></li><li><a href="LocalPipelineRunnerPool.html#event:run:end">run:end</a></li><li><a href="LocalPipelineRunnerPool.html#event:run:start">run:start</a></li><li><a href="Pipeline.html#event:save-request">save-request</a></li><li><a href="PipelineRunner.html#event:noop:noData">noop:noData</a></li><li><a href="PipelineRunner.html#event:noop:noStateChange">noop:noStateChange</a></li><li><a href="PipelineRunnerPool.html#event:computation:complete">computation:complete</a></li><li><a href="PipelineRunnerPool.html#event:ready">ready</a></li><li><a href="PipelineRunnerPool.html#event:listener:created">listener:created</a></li><li><a href="PipelineRunnerPool.html#event:pipeline:inProgress">pipeline:inProgress</a></li><li><a href="PipelineRunnerPool.html#event:queue:end">queue:end</a></li><li><a href="PipelineRunnerPool.html#event:queue:start">queue:start</a></li><li><a href="PipelineRunnerPool.html#event:run:end">run:end</a></li><li><a href="PipelineRunnerPool.html#event:run:start">run:start</a></li><li><a href="RemotePipelineRunner.html#event:noop:noData">noop:noData</a></li><li><a href="RemotePipelineRunner.html#event:noop:noStateChange">noop:noStateChange</a></li><li><a href="RemotePipelineRunnerPool.html#event:computation:complete">computation:complete</a></li><li><a href="RemotePipelineRunnerPool.html#event:ready">ready</a></li><li><a href="RemotePipelineRunnerPool.html#event:listener:created">listener:created</a></li><li><a href="RemotePipelineRunnerPool.html#event:pipeline:inProgress">pipeline:inProgress</a></li><li><a href="RemotePipelineRunnerPool.html#event:queue:end">queue:end</a></li><li><a href="RemotePipelineRunnerPool.html#event:queue:start">queue:start</a></li><li><a href="RemotePipelineRunnerPool.html#event:run:end">run:end</a></li><li><a href="RemotePipelineRunnerPool.html#event:run:start">run:start</a></li></ul><h3>Global</h3><ul><li><a href="global.html#cleanupTestDir">cleanupTestDir</a></li><li><a href="global.html#filterComputation">filterComputation</a></li><li><a href="global.html#getMockComputations">getMockComputations</a></li><li><a href="global.html#localResultOpts">localResultOpts</a></li><li><a href="global.html#MOCK_COMPUTATION_PATH">MOCK_COMPUTATION_PATH</a></li><li><a href="global.html#remoteResultOpts">remoteResultOpts</a></li><li><a href="global.html#seedInstanceComputations">seedInstanceComputations</a></li><li><a href="global.html#setupNetworkStubs">setupNetworkStubs</a></li><li><a href="global.html#setupTestDir">setupTestDir</a></li><li><a href="global.html#TEST_COMPUTATION_PATH">TEST_COMPUTATION_PATH</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">test/services/computation-registry-factory.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>'use strict';

require('../helpers/boot');
const ComputationRegistry =
    require('../../src/services/classes/computation-registry');
const computationRegistryFactory =
    require('../../src/services/computation-registry-factory');
const DBRegistry = require('../../src/services/classes/db-registry');
const fs = require('fs');
const helpers = require('../helpers/computation-registry-helpers');
const mockDecentralizedComputations =
    require('../mocks/decentralized-computations.json');
const path = require('path');
const sinon = require('sinon');
const tape = require('tape');

const REPO_PATH = path.join(__dirname, '..', '..');

function getValidLocalOptions() {
  return {
    dbRegistry: new DBRegistry({
      localStores: ['computations'],
      pouchConfig: {
        adapter: 'memory',
      },
      remote: {
        db: 'https://localhost:1234',
      },
    }),
    isLocal: true,
  };
}

tape('works without configuration', t => {
  t.plan(1);

  computationRegistryFactory()
        .then(computationRegistry => {
          t.ok(
                computationRegistry &amp;&amp;
                computationRegistry instanceof ComputationRegistry,
                'returns a registry instance'
            );
        })
        .catch(t.end);
});

tape('passes custom registry', t => {
  t.plan(1);

  computationRegistryFactory({
    registry: mockDecentralizedComputations,
  })
        .then(computationRegistry => {
          t.equal(
                computationRegistry.registry,
                mockDecentralizedComputations
            );
        })
        .catch(t.end);
});

tape('sets path', t => {
  t.plan(2);

  const customPath = path.join(
        __dirname, '..', 'mocks', 'decentralized-computations.json'
    );

  computationRegistryFactory()
        .then(computationRegistry => {
          t.ok(
                computationRegistry.path.indexOf(REPO_PATH) !== -1,
                'sets computation path in repo for remote'
            );
        })
        .catch(t.end);

  computationRegistryFactory({ path: customPath })
        .then(computationRegistry => {
          t.equal(
                computationRegistry.path,
                customPath,
                'sets custom path'
            );
        })
        .catch(t.end);
});

tape('scan disk handles error', t => {
  t.plan(1);

  const readdirStub = sinon.stub(fs, 'readdir');
  readdirStub.yields(new Error('pineapples'), null);

  computationRegistryFactory({
    path: helpers.TEST_COMPUTATION_PATH,
    scanDisk: true,
  })
        .then(() => t.fail('expected readdir error'))
        .catch(error => {
          readdirStub.restore();
          t.equal(error.message, 'pineapples', 'handles readdir error');
        });
});

tape('scans disk for existing computations', t => {
  t.plan(5);

  const name1 = 'a-small-bag';
  const name2 = 'the-ravens';
  const version1 = '1.0.0-beta';
  const version2 = '2.0.0';

  helpers.setupTestDir([name1 + '@' + version1, name2 + '@' + version2])
        .then(() => computationRegistryFactory({
          path: helpers.TEST_COMPUTATION_PATH,
          scanDisk: true,
        }))
        .then(computationRegistry => {
          t.ok(computationRegistry, 'gets registry');
          t.equal(
                Object.keys(computationRegistry.store).length,
                2,
                'only stores existing computations'
            );

            /**
             * Hijack ComputationRegistry's private method to make sure it
             * doesn't retrieve from disk again.
             */
          computationRegistry._getFromDisk = function () {
            throw new Error('Attempted to get definition from disk');
          };

          return Promise.all([
            computationRegistry.get(name1, version1),
            computationRegistry.get(name2, version2),
          ]);
        })
        .then(computations => {
          t.ok(
                computations[0].name === name1 &amp;&amp;
                computations[0].version === version1,
                'stores first in memory'
            );
          t.ok(
                computations[1].name === name2 &amp;&amp;
                computations[1].version === version2,
                'stores second in memory'
            );
        })
        .catch(t.end)
        .then(helpers.cleanupTestDir)
        .then(() => t.pass('test cleanup'));
});

tape('isLocal throws proper config', t => {
  t.throws(
        computationRegistryFactory.bind(null, {
          isLocal: true,
        }),
        'throws without dbRegistry'
    );
  t.throws(
        computationRegistryFactory.bind(null, {
          dbRegistry: 'dbRegistry',
          isLocal: true,
        }),
        'throws with bad dbRegistry'
    );
  t.end();
});

tape('configures local computation registry', t => {
  t.plan(3);

  computationRegistryFactory(getValidLocalOptions())
        .then(computationRegistry => {
          t.ok(computationRegistry, 'returns computation registry');
          t.equal(
                computationRegistry.registry.length,
                0,
                'sets empty internal registry'
            );
          t.ok(
                computationRegistry.path.indexOf(REPO_PATH) === -1,
                'sets path outside of repo'
            );
        })
        .catch(t.end);
});

tape('local computation registry fetches computations from source', t => {
  t.plan(4);

  const compAddStub = sinon.stub(ComputationRegistry.prototype, 'add');
  const options = getValidLocalOptions();
  const name = 'the-ravens';
  const spy = sinon.spy();
  const version = '2.0.0';

  const dbGetStub = sinon.stub(options.dbRegistry, 'get');
  const returnDocs = mockDecentralizedComputations.reduce((all, c) => {
    if (c.name !== name) {
      return all;
    }

    return all.concat(c.tags.filter(t => t === version).map(version => {
      return {
        name: c.name,
        version,
        url: c.url,
      };
    }));
  }, []);

  dbGetStub.returns({
    find: () => {
      spy.apply(spy, arguments);

      return Promise.resolve({
        docs: returnDocs,
      });
    },
  });

  computationRegistryFactory(options)
  .then(computationRegistry => {
    t.ok(dbGetStub.calledWith('computations'), 'gets computations DB');
    return computationRegistry.add(name, version)
    .then(() => {
      t.equal(
        spy.callCount,
        1,
        'gets all documents from computations DB'
      );
      t.deepEqual(
        computationRegistry.registry[0],
        {
          name,
          tags: [version],
          url: returnDocs[0].url,
        },
        'sets computations docs to internal registry'
      );
      t.deepEqual(
        compAddStub.firstCall.args,
        [name, version],
        'proxies to ComputationRegistry#add'
      );
      compAddStub.restore();
      dbGetStub.restore();
    });
  })
  .catch(t.end);
});

tape('local computation registry mutates whitelist', t => {
  t.plan(2);

    // Prevent network calls by stubbing 'add':
  const compAddStub = sinon.stub(ComputationRegistry.prototype, 'add');
  const options = getValidLocalOptions();
  const name = 'the-ravens';
  const version = '2.0.0';
  const url = 'https://github.com/MRN-Code/the-ravens';

  const dbGetStub = sinon.stub(options.dbRegistry, 'get');
  const registry = [{
    name,
    tags: ['1.0.0', '3.0.0'],
    url,
  }];

  dbGetStub.returns({
    find: () => Promise.resolve({
      docs: [{ name, version, url }],
    }),
  });

  options.registry = registry;

  computationRegistryFactory(options)
    .then(computationRegistry => Promise.all([
      Promise.resolve(computationRegistry),
      computationRegistry.add(name, version),
    ]))
    .then(responses => {
      const instance = responses[0];
      t.equal(instance.registry, registry, 'keeps passed registry');
      t.ok(
        instance.registry[0].tags.indexOf(version) !== -1,
        'adds version to existing registry item'
      );
    })
    .catch(t.end)
    .then(() => {
      compAddStub.restore();
      dbGetStub.restore();
    });
});

tape('local computation registry handles not-found computation', t => {
  t.plan(1);

  const options = getValidLocalOptions();
  const name = 'the-ravens';
  const version = '2.0.0';

  const dbGetStub = sinon.stub(options.dbRegistry, 'get');

  dbGetStub.returns({
    find: () => Promise.resolve({ docs: [] }),
  });

  computationRegistryFactory(options)
        .then(computationRegistry => computationRegistry.add(name, version))
        .then(() => t.fail('expected not-found error'))
        .catch(() => t.pass('rejects with not-found error'))
        .then(() => dbGetStub.restore());
});
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
